<!DOCTYPE html>
<html>
<head>
  <base target="_top">
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

  <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;600;700&display=swap" rel="stylesheet">

  <style>
    body { font-family: "Prompt", sans-serif; }
    
    /* Soft Shadow */
    .soft-card {
      box-shadow: 0 8px 20px rgba(0,0,0,0.08);
      border-radius: 18px;
      transition: all .25s ease;
      backdrop-filter: blur(6px);
    }
    .soft-card:hover {
      transform: translateY(-3px);
      box-shadow: 0 10px 25px rgba(0,0,0,0.15);
    }

    /* Modern Button */
    .btn-modern {
      background: linear-gradient(135deg,#ff8c3c,#ff5e00);
      transition: all .2s ease-in-out;
    }
    .btn-modern:hover {
      background: linear-gradient(135deg,#ff7a1c,#ff4a00);
      transform: translateY(-2px);
      box-shadow: 0 6px 16px rgba(255,115,0,0.4);
    }

    /* Input Style */
    .form-input {
      @apply w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500;
    }

    /* Footer Blur */
    .footer-glass {
      backdrop-filter: blur(8px);
      background: rgba(255,255,255,0.8);
    }

    /* Fade in Animation */
    .fade-in {
      animation: fadeIn .6s ease-out;
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to   { opacity: 1; transform: translateY(0); }
    }
  </style>
</head>

<body class="bg-gradient-to-br from-orange-50 to-white pb-32">

  <!-- HEADER -->
  <header class="py-8 bg-gradient-to-r from-orange-500 to-orange-600 text-white text-center shadow-lg">
    <h1 class="text-4xl font-extrabold tracking-wide drop-shadow-lg">
      üçΩÔ∏è ASL 
    </h1>
    <p class="mt-2 text-orange-100 text-lg">‡∏™‡∏±‡πà‡∏á‡∏á‡πà‡∏≤‡∏¢ ‚Ä¢ ‡∏≠‡∏£‡πà‡∏≠‡∏¢ ‚Ä¢ ‡∏™‡πà‡∏á‡∏ï‡∏£‡∏á‡πÄ‡∏ß‡∏•‡∏≤</p>
  </header>

  <div class="max-w-4xl mx-auto mt-6 p-6 soft-card bg-white fade-in">
      
    <!-- FORM -->
    <form id="preOrderForm" onsubmit="handleFormSubmit(this); return false;">

      <!-- ‡∏ú‡∏π‡πâ‡∏™‡∏±‡πà‡∏á -->
      <section class="mb-8">
        <h2 class="text-xl font-bold text-gray-800 mb-3 flex items-center">
          üë§ ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡∏™‡∏±‡πà‡∏á
          <span class="ml-2 text-sm font-light text-gray-500">(‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö)</span>
        </h2>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <div class="soft-card p-4 bg-white">
            <label class="text-sm text-gray-600 mb-1 block">‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏™‡∏±‡πà‡∏á <span class="text-red-500">*</span></label>
            <input type="text" name="customerName" required class="form-input" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏ß‡∏£‡∏±‡∏ç‡∏ç‡∏≤">
          </div>

          <div class="soft-card p-4 bg-white">
            <label class="text-sm text-gray-600 mb-1 block">‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£ / ‡∏´‡πâ‡∏≠‡∏á <span class="text-red-500">*</span></label>
            <input type="text" name="contactInfo" required class="form-input" placeholder="‡πÄ‡∏ä‡πà‡∏ô 081-xxx-xxxx">
          </div>
        </div>
      </section>

      <!-- ‡∏ß‡∏±‡∏ô‡∏£‡∏±‡∏ö -->
      <section class="mb-8">
        <h2 class="text-xl font-bold text-gray-800 mb-3">üìÖ ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ö‡∏≠‡∏≤‡∏´‡∏≤‡∏£</h2>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <div class="soft-card p-4 bg-white">
            <label class="text-sm text-gray-600">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏±‡πà‡∏á</label>
            <input type="date" id="orderDate" name="orderDate" readonly class="form-input bg-gray-100 text-gray-500 cursor-not-allowed">
          </div>

          <div class="soft-card p-4 bg-white">
            <label class="text-sm text-gray-600">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ö <span class="text-red-500">*</span></label>
            <input type="date" id="deliveryDate" name="deliveryDate" required class="form-input">
          </div>
        </div>
      </section>

      <!-- ‡πÄ‡∏°‡∏ô‡∏π -->
      <section class="mb-8">
        <h2 class="text-2xl font-bold text-gray-800 mb-6">üç± ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏°‡∏ô‡∏π‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£</h2>

        <div id="menuContainer" class="grid grid-cols-1 sm:grid-cols-2 gap-6">
          <div class="text-center py-10 text-gray-400 animate-pulse">‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏°‡∏ô‡∏π...</div>
        </div>

        <?!= include('MenuTemplate'); ?> 
      </section>

      <!-- ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏ -->
      <section class="mb-8">
        <h2 class="text-lg font-bold text-gray-800 mb-2">üìù ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°</h2>
        <textarea name="additionalNotes" rows="3" class="form-input soft-card" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ú‡∏±‡∏Å, ‡πÄ‡∏ú‡πá‡∏î‡∏°‡∏≤‡∏Å, ‡πÑ‡∏°‡πà‡πÉ‡∏™‡πà‡∏ï‡πâ‡∏ô‡∏´‡∏≠‡∏°"></textarea>
      </section>

      <!-- FOOTER -->
      <div class="fixed bottom-0 left-0 w-full footer-glass border-t shadow-[0_-4px_10px_rgba(0,0,0,0.1)] p-4 z-50">
        <div class="max-w-4xl mx-auto flex justify-between items-center">
          
          <div>
            <p class="text-sm text-gray-600">‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</p>
            <p id="totalPriceDisplay" class="text-3xl font-extrabold text-orange-600 drop-shadow-sm">0 ‡∏ø</p>
          </div>

          <button id="submitButton"
            type="submit"
            class="btn-modern text-white font-bold py-3 px-10 rounded-full text-lg shadow-xl">
            ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå
          </button>
        </div>
      </div>

    </form>
  </div>

<script>
/* ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏ß‡∏±‡∏ô */
document.addEventListener('DOMContentLoaded', () => {
  const today = new Date();
  const tomorrow = new Date(today);
  tomorrow.setDate(today.getDate() + 1);

  const format = d => d.toISOString().split('T')[0];

  document.getElementById('orderDate').value = format(today);
  document.getElementById('deliveryDate').value = format(tomorrow);
});

/* ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏£‡∏≤‡∏Ñ‡∏≤ */
function calculateTotal() {
  let total = 0;
  document.querySelectorAll('.menu-item-card').forEach(card => {
    const cb = card.querySelector('input[type="checkbox"]');
    if (cb && cb.checked) {
      const price = parseFloat(card.dataset.price || 0);
      const qty = parseInt(card.querySelector('input[type="number"]').value || 1);
      total += price * qty;
    }
  });

  document.getElementById("totalPriceDisplay").innerText = total.toLocaleString() + " ‡∏ø";
  return total;
}

document.addEventListener("change", () => calculateTotal());

/* ‡∏™‡πà‡∏á‡∏ü‡∏≠‡∏£‡πå‡∏° */
function handleFormSubmit(form) {
  const total = calculateTotal();
  if (total <= 0) {
    Swal.fire({
      icon: "warning",
      title: "‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏°‡∏ô‡∏π",
      text: "‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏°‡∏ô‡∏π‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 1 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£",
      confirmButtonColor: "#ff6600"
    });
    return;
  }

  const formData = {
    customerName: form.customerName.value,
    contactInfo: form.contactInfo.value,
    orderDate: form.orderDate.value,
    deliveryDate: form.deliveryDate.value,
    additionalNotes: form.additionalNotes.value,
    totalPrice: total,
    items: []
  };

  document.querySelectorAll(".menu-item-card").forEach(card => {
    const cb = card.querySelector("input[type='checkbox']");
    if (cb.checked) {
      const id = cb.value;
      formData.items.push({
        name: card.dataset.name,
        quantity: card.querySelector("input[type='number']").value,
        spiciness: card.querySelector(`input[name="spicy_${id}"]:checked`)?.value || "-"
      });
    }
  });

  google.script.run
    .withSuccessHandler(res => {
      Swal.fire({
        icon: "success",
        title: "‡∏™‡∏±‡πà‡∏á‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!",
        html: `<b>‡∏£‡∏´‡∏±‡∏™‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå:</b> ${res.orderId}<br><b>‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°:</b> ${res.totalPrice} ‡∏ø`,
        confirmButtonColor: "#ff6600"
      }).then(() => location.reload());
    })
    .withFailureHandler(err => {
      Swal.fire("‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î", err.message, "error");
    })
    .processForm(formData);
}

</script>

</body>
</html>
